/*! stackmob-js-sdk 1.0.0 */this.JSON||(this.JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?(this._wrapped=a,void 0):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.1";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(null==b?x.identity:b);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e=null;return function(){var f=this,g=arguments,h=function(){e=null,c||(d=a.apply(f,g))},i=c&&!e;return clearTimeout(e),e=setTimeout(h,b),i&&(d=a.apply(f,g)),d}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(a){function b(a){var b=r[a]={};return k(a.split(/\s+/),function(a){b[a]=!0}),b}var c={},d=Array.prototype,e=Object.prototype,f=e.hasOwnProperty,g=e.toString,h=d.forEach,i=d.indexOf,j=d.slice,k=function(a,b,d){var e,g,i;if(a)if(h&&a.forEach===h)a.forEach(b,d);else if(a.length===+a.length){for(g=0,i=a.length;i>g;g++)if(g in a&&b.call(d,a[g],g,a)===c)return}else for(e in a)if(f.call(a,e)&&b.call(d,a[e],e,a)===c)return},l=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},m=function(a){return k(j.call(arguments,1),function(b){var c;for(c in b)void 0!==b[c]&&(a[c]=b[c])}),a},n=function(a,b,c){var d;if(b){if(i)return i.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},o={};k("Boolean Number String Function Array Date RegExp Object".split(" "),function(a){o["[object "+a+"]"]=a.toLowerCase()});var p=function(a){return null==a?String(a):o[g.call(a)]||"object"},q={},r={};q.Callbacks=function(a){a="string"==typeof a?r[a]||b(a):m({},a);var c,d,e,f,g,h,i=[],j=!a.once&&[],l=function(b){for(c=a.memory&&b,d=!0,h=f||0,f=0,g=i.length,e=!0;i&&g>h;h++)if(i[h].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&l(j.shift()):c?i=[]:o.disable())},o={add:function(){if(i){var b=i.length;!function d(b){k(b,function(b){var c=p(b);"function"===c?a.unique&&o.has(b)||i.push(b):b&&b.length&&"string"!==c&&d(b)})}(arguments),e?g=i.length:c&&(f=b,l(c))}return this},remove:function(){return i&&k(arguments,function(a){for(var b;(b=n(a,i,b))>-1;)i.splice(b,1),e&&(g>=b&&g--,h>=b&&h--)}),this},has:function(a){return n(a,i)>-1},empty:function(){return i=[],this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||o.disable(),this},locked:function(){return!j},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],!i||d&&!j||(e?j.push(b):l(b)),this},fire:function(){return o.fireWith(this,arguments),this},fired:function(){return!!d}};return o},q.Deferred=function(a){var b=[["resolve","done",q.Callbacks("once memory"),"resolved"],["reject","fail",q.Callbacks("once memory"),"rejected"],["notify","progress",q.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return q.Deferred(function(c){k(b,function(b,d){var f=b[0],g=a[d];e[b[1]](l(g)?function(){var a;try{a=g.apply(this,arguments)}catch(b){return c.reject(b),void 0}a&&l(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c["notify"!==f?"resolveWith":f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return null!=a?m(a,d):d}},e={};return d.pipe=d.then,k(b,function(a,f){var g=a[2],h=a[3];d[a[1]]=g.add,h&&g.add(function(){c=h},b[1^f][2].disable,b[2][2].lock),e[a[0]]=g.fire,e[a[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},q.when=function(a){var b,c,d,e=0,f="array"===p(a)&&1===arguments.length?a:j.call(arguments),g=f.length,h=1!==g||a&&l(a.promise)?g:0,i=1===h?a:q.Deferred(),k=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?j.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&l(f[e].promise)?f[e].promise().done(k(e,d,f)).fail(i.reject).progress(k(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()},"undefined"!=typeof module&&module.exports?module.exports=q:"undefined"!=typeof a._?a._.mixin(q):a._=q}(this),function(){var a,b=this,c=b.Backbone,d=[],e=d.push,f=d.slice,g=d.splice;a="undefined"!=typeof exports?exports:b.Backbone={},a.VERSION="1.0.0";var h=b._;h||"undefined"==typeof require||(h=require("underscore")),a.$=b.jQuery||b.Zepto||b.ender||b.$,a.noConflict=function(){return b.Backbone=c,this},a.emulateHTTP=!1,a.emulateJSON=!1;var i=a.Events={on:function(a,b,c){if(!k(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!k(this,"once",a,[b,c])||!b)return this;var d=this,e=h.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,g,i,j,l,m;if(!this._events||!k(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:h.keys(this._events),i=0,j=g.length;j>i;i++)if(a=g[i],f=this._events[a]){if(this._events[a]=d=[],b||c)for(l=0,m=f.length;m>l;l++)e=f[l],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=f.call(arguments,1);if(!k(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&l(c,b),d&&l(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}},j=/\s+/,k=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(j.test(c)){for(var f=c.split(j),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},l=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},m={listenTo:"on",listenToOnce:"once"};h.each(m,function(a,b){i[b]=function(b,c,d){var e=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=h.uniqueId("l"));return e[f]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}}),i.bind=i.on,i.unbind=i.off,h.extend(a,i);var n=a.Model=function(a,b){var c,d=a||{};b||(b={}),this.cid=h.uniqueId("c"),this.attributes={},h.extend(this,h.pick(b,o)),b.parse&&(d=this.parse(d,b)||{}),(c=h.result(this,"defaults"))&&(d=h.defaults({},d,c)),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)},o=["url","urlRoot","collection"];h.extend(n.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return h.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,f,g,i,j,k,l;if(null==a)return this;if("object"==typeof a?(e=a,c=b):(e={})[a]=b,c||(c={}),!this._validate(e,c))return!1;f=c.unset,i=c.silent,g=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=h.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],h.isEqual(l[d],b)||g.push(d),h.isEqual(k[d],b)?delete this.changed[d]:this.changed[d]=b,f?delete l[d]:l[d]=b;if(!i){g.length&&(this._pending=!0);for(var m=0,n=g.length;n>m;m++)this.trigger("change:"+g[m],this,l[g[m]],c)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,h.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,h.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)h.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){return b.set(b.parse(d,a),a)?(c&&c(b,d,a),b.trigger("sync",b,d,a),void 0):!1},L(this,a),this.sync("read",this,a)},save:function(a,b,c){var d,e,f,g=this.attributes;if(null==a||"object"==typeof a?(d=a,c=b):(d={})[a]=b,!(!d||c&&c.wait||this.set(d,c)))return!1;if(c=h.extend({validate:!0},c),!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=h.extend({},g,d)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=g;var b=i.parse(a,c);return c.wait&&(b=h.extend(d||{},b)),h.isObject(b)&&!i.set(b,c)?!1:(j&&j(i,a,c),i.trigger("sync",i,a,c),void 0)},L(this,c),e=this.isNew()?"create":c.patch?"patch":"update","patch"===e&&(c.attrs=d),f=this.sync(e,this,c),d&&c.wait&&(this.attributes=g),f},destroy:function(a){a=a?h.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(e){(a.wait||b.isNew())&&d(),c&&c(b,e,a),b.isNew()||b.trigger("sync",b,e,a)},this.isNew())return a.success(),!1;L(this,a);var e=this.sync("delete",this,a);return a.wait||d(),e},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||K();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},h.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=h.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,h.extend(b||{},{validationError:c})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];h.each(p,function(a){n.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.attributes),h[a].apply(h,b)}});var q=a.Collection=function(a,b){b||(b={}),b.url&&(this.url=b.url),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,h.extend({silent:!0},b))},r={add:!0,remove:!0,merge:!0},s={add:!0,merge:!1,remove:!1};h.extend(q.prototype,i,{model:n,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return a.sync.apply(this,arguments)},add:function(a,b){return this.set(a,h.defaults(b||{},s))},remove:function(a,b){a=h.isArray(a)?a.slice():[a],b||(b={});var c,d,e,f;for(c=0,d=a.length;d>c;c++)f=this.get(a[c]),f&&(delete this._byId[f.id],delete this._byId[f.cid],e=this.indexOf(f),this.models.splice(e,1),this.length--,b.silent||(b.index=e,f.trigger("remove",f,this,b)),this._removeReference(f));return this},set:function(a,b){b=h.defaults(b||{},r),b.parse&&(a=this.parse(a,b)),h.isArray(a)||(a=a?[a]:[]);var c,d,f,i,j,k=b.at,l=this.comparator&&null==k&&b.sort!==!1,m=h.isString(this.comparator)?this.comparator:null,n=[],o=[],p={};for(c=0,d=a.length;d>c;c++)(f=this._prepareModel(a[c],b))&&((i=this.get(f))?(b.remove&&(p[i.cid]=!0),b.merge&&(i.set(f.attributes,b),l&&!j&&i.hasChanged(m)&&(j=!0))):b.add&&(n.push(f),f.on("all",this._onModelEvent,this),this._byId[f.cid]=f,null!=f.id&&(this._byId[f.id]=f)));if(b.remove){for(c=0,d=this.length;d>c;++c)p[(f=this.models[c]).cid]||o.push(f);o.length&&this.remove(o,b)}if(n.length&&(l&&(j=!0),this.length+=n.length,null!=k?g.apply(this.models,[k,0].concat(n)):e.apply(this.models,n)),j&&this.sort({silent:!0}),b.silent)return this;for(c=0,d=n.length;d>c;c++)(f=n[c]).trigger("add",f,this,b);return j&&this.trigger("sort",this,b),this},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),this.add(a,h.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:this.length},b)),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return a=this._prepareModel(a,b),this.add(a,h.extend({at:0},b)),a},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a.cid||a]},at:function(a){return this.models[a]},where:function(a,b){return h.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),h.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=h.isFunction(b)?b:function(a){return a.get(b)};return h.sortedIndex(this.models,a,d,c)},pluck:function(a){return h.invoke(this.models,"get",a)},fetch:function(a){a=a?h.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},L(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?h.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(e){b.wait&&c.add(a,b),d&&d(a,e,b)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof n)return a.collection||(a.collection=this),a;b||(b={}),b.collection=this;var c=new this.model(a,b);return c._validate(a,b)?c:(this.trigger("invalid",this,a,b),!1)},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var t=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];h.each(t,function(a){q.prototype[a]=function(){var b=f.call(arguments);return b.unshift(this.models),h[a].apply(h,b)}});var u=["groupBy","countBy","sortBy"];h.each(u,function(a){q.prototype[a]=function(b,c){var d=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,d,c)}});var v=a.View=function(a){this.cid=h.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];h.extend(v.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this
},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(b,c){return this.$el&&this.undelegateEvents(),this.$el=b instanceof a.$?b:a.$(b),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=h.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(h.isFunction(c)||(c=this[a[b]]),c){var d=b.match(w),e=d[1],f=d[2];c=h.bind(c,this),e+=".delegateEvents"+this.cid,""===f?this.$el.on(e,c):this.$el.on(e,f,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(a){this.options&&(a=h.extend({},h.result(this,"options"),a)),h.extend(this,h.pick(a,x)),this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var b=h.extend({},h.result(this,"attributes"));this.id&&(b.id=h.result(this,"id")),this.className&&(b["class"]=h.result(this,"className"));var c=a.$("<"+h.result(this,"tagName")+">").attr(b);this.setElement(c,!1)}}}),a.sync=function(b,c,d){var e=y[b];h.defaults(d||(d={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var f={type:e,dataType:"json"};if(d.url||(f.url=h.result(c,"url")||K()),null!=d.data||!c||"create"!==b&&"update"!==b&&"patch"!==b||(f.contentType="application/json",f.data=JSON.stringify(d.attrs||c.toJSON(d))),d.emulateJSON&&(f.contentType="application/x-www-form-urlencoded",f.data=f.data?{model:f.data}:{}),d.emulateHTTP&&("PUT"===e||"DELETE"===e||"PATCH"===e)){f.type="POST",d.emulateJSON&&(f.data._method=e);var g=d.beforeSend;d.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",e),g?g.apply(this,arguments):void 0}}"GET"===f.type||d.emulateJSON||(f.processData=!1),"PATCH"!==f.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(f.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=d.xhr=a.ajax(h.extend(f,d));return c.trigger("request",c,i,d),i};var y={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var z=a.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,B=/(\(\?)?:\w+/g,C=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(z.prototype,i,{initialize:function(){},route:function(b,c,d){h.isRegExp(b)||(b=this._routeToRegExp(b)),h.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return a.history.route(b,function(f){var g=e._extractParameters(b,f);d&&d.apply(e,g),e.trigger.apply(e,["route:"+c].concat(g)),e.trigger("route",c,g),a.history.trigger("route",e,c,g)}),this},navigate:function(b,c){return a.history.navigate(b,c),this},_bindRoutes:function(){if(this.routes){this.routes=h.result(this,"routes");for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(D,"\\$&").replace(A,"(?:$1)?").replace(B,function(a,b){return b?a:"([^/]+)"}).replace(C,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return h.map(c,function(a){return a?decodeURIComponent(a):null})}});var E=a.History=function(){this.handlers=[],h.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,G=/^\/+|\/+$/g,H=/msie [\w.]+/,I=/\/$/;E.started=!1,h.extend(E.prototype,i,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(I,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(F,"")},start:function(b){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=h.extend({},{root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var c=this.getFragment(),d=document.documentMode,e=H.exec(navigator.userAgent.toLowerCase())&&(!d||7>=d);this.root=("/"+this.root+"/").replace(G,"/"),e&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=c;var f=this.location,g=f.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!g?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&g&&f.hash&&(this.fragment=this.getHash().replace(F,""),this.history.replaceState({},document.title,this.root+this.fragment+f.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=h.any(this.handlers,function(a){return a.route.test(b)?(a.callback(b),!0):void 0});return c},navigate:function(a,b){if(!E.started)return!1;if(b&&b!==!0||(b={trigger:b}),a=this.getFragment(a||""),this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),a.history=new E;var J=function(a,b){var c,d=this;c=a&&h.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},h.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&h.extend(c.prototype,a),c.__super__=d.prototype,c};n.extend=q.extend=z.extend=v.extend=E.extend=J;var K=function(){throw new Error('A "url" property or function must be specified')},L=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}}}.call(this),/*!
 StackMob JS SDK Version 1.0.0
 Copyright 2012-2013 StackMob Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 */
function(){var a=this,b="undefined"!=typeof window?window:{location:{hostname:"api.stackmob.com",port:"443",protocol:"https:"}};b.StackMob=a.StackMob={DEFAULT_API_VERSION:0,DEFAULT_LOGIN_SCHEMA:"user",DEFAULT_LOGIN_FIELD:"username",DEFAULT_PASSWORD_FIELD:"password",EARTH_RADIANS_MI:3956.6,EARTH_RADIANS_KM:6367.5,FORCE_CREATE_REQUEST:"stackmob_force_create_request",ARRAY_FIELDNAME:"stackmob_array_fieldname",ARRAY_VALUES:"stackmob_array_values",CASCADE_DELETE:"stackmob_cascade_delete",HARD_DELETE:!0,SOFT_DELETE:!1,API_SERVER:"api.stackmob.com",RETRY_WAIT:1e4,RETRY_ATTEMPTS:3,REFRESH_TOKEN_KEY:"oauth2.refreshToken",POST:"POST",PUT:"PUT",DELETE:"DELETE",CONTENT_TYPE_JSON:"application/json",SECURE_ALWAYS:"ALWAYS",SECURE_MIXED:"MIXED",SECURE_NEVER:"NEVER",apiVersion:0,sdkVersion:"1.0.0",publicKey:null,getProtocol:function(){return b.location.protocol},getHostname:function(){return b.location.hostname},getPort:function(){return b.location.port},Storage:{STORAGE_PREFIX:"stackmob.",persist:function(a,b){localStorage&&localStorage.setItem(this.STORAGE_PREFIX+a,b)},retrieve:function(a){return localStorage?localStorage.getItem(this.STORAGE_PREFIX+a):null},remove:function(a){localStorage&&localStorage.removeItem(this.STORAGE_PREFIX+a)}},_generateCallbacks:function(a,b){return a=a||{},a.success=function(a){b.isValidResult(a)?"function"==typeof b.yes&&b.yes(a):"function"==typeof b.no&&b.no(a)},a.error||"function"!=typeof b.error||(a.error=b.error),a},_containsCallbacks:function(a,b){return"object"==typeof a&&_.some(b,function(b){return"function"==typeof a[b]})},getLoggedInUser:function(a){var b=!this.isOAuth2Mode()&&this.Storage.retrieve(this.loggedInUserKey)||this.Storage.retrieve("oauth2.user");return a&&a.success?(this.hasValidOAuth(a),void 0):this.isLoggedIn(a)&&b?b:null},isLoggedIn:function(a){return this._containsCallbacks(a,["yes","no"])?(a=this._generateCallbacks(a,{isValidResult:function(a){return"undefined"!=typeof a},yes:a.yes,no:a.no,error:a.no}),this.hasValidOAuth(a),void 0):!this.isLoggedOut()||this.hasValidOAuth(a)},isUserLoggedIn:function(a,b){return this._containsCallbacks(b,["yes","no"])?(b=this._generateCallbacks(b,{isValidResult:function(b){return b==a},yes:b.yes,no:b.no,error:b.no}),this.hasValidOAuth(b),void 0):a==this.getLoggedInUser(b)},isLoggedOut:function(a){return this._containsCallbacks(a,["yes","no"])?(a=this._generateCallbacks(a,{isValidResult:function(a){return"undefined"==typeof a},yes:a.yes,no:a.no,error:a.yes}),this.hasValidOAuth(a),void 0):!this.hasValidOAuth(a)},getBaseURL:function(){return StackMob.useRelativePathForAjax?StackMob.apiDomain?StackMob.apiDomain:this.getHostname()+(this.getPort()?":"+this.getPort():"")+"/":StackMob.apiDomain?StackMob.apiDomain:StackMob.API_SERVER+"/"},throwError:function(a){throw new Error(a)},urlError:function(){this.throwError('A "url" property or function must be specified')},requirePublicKey:function(){StackMob.publicKey||this.throwError("Error: This requires that you initialize StackMob with a public key.")},isOAuth2Mode:function(){return!isNaN(StackMob.publicKey&&!StackMob.privateKey)},prepareCredsForSaving:function(a,b,c,d,e,f){var g=(new Date).getTime()+1e3*this._stubbedExpireTime(d),h={"oauth2.accessToken":a,"oauth2.macKey":c,"oauth2.expires":g,"oauth2.user":e,"oauth2.userSchemaInfo":f};return h[StackMob.REFRESH_TOKEN_KEY]=b,h},_stubbedExpireTime:function(a){return a},saveOAuthCredentials:function(a){var b=a["oauth2.accessToken"],c=a[StackMob.REFRESH_TOKEN_KEY];this.Storage.retrieve("oauth2.accessToken")!=b&&this.Storage.persist("oauth2.expires",a["oauth2.expires"]),this.Storage.persist("oauth2.accessToken",b),this.Storage.persist(StackMob.REFRESH_TOKEN_KEY,c),this.Storage.persist("oauth2.macKey",a["oauth2.macKey"]),this.Storage.persist("oauth2.user",a["oauth2.user"]),this.Storage.persist("oauth2.userSchemaInfo",JSON.stringify(a["oauth2.userSchemaInfo"]))},hasValidOAuth:function(a){if(a=a||{},!this.isOAuth2Mode())return a&&a.error&&a.error(),!1;var b=this.getOAuthCredentials(),c=b&&b["oauth2.expires"]||0;if(!_.all([b["oauth2.accessToken"],b["oauth2.macKey"],c],_.identity))return a&&a.success&&a.success(void 0),!1;if(!StackMob.hasExpiredOAuth())return a&&a.success&&a.success(this.Storage.retrieve("oauth2.user")),this.Storage.retrieve("oauth2.user");if(!a||!a.success)return!1;var d=a.success;a.success=function(a){var b=StackMob.getOAuthCredentials(),c=b["oauth2.userSchemaInfo"]&&b["oauth2.userSchemaInfo"].loginField?b["oauth2.userSchemaInfo"].loginField:this.loginField;d(a[c])},this.initiateRefreshSessionCall(a)},initiateRefreshSessionCall:function(a){StackMob.refreshSession.call(StackMob,a)},shouldSendRefreshToken:function(){return this.hasExpiredOAuth()&&this.hasRefreshToken()&&this.shouldKeepLoggedIn()},keepLoggedIn:function(a){StackMob.Storage.persist("oauth2.shouldKeepLoggedIn",a===!0)},shouldKeepLoggedIn:function(){return"true"===StackMob.Storage.retrieve("oauth2.shouldKeepLoggedIn")},hasRefreshToken:function(){var a=this.getOAuthCredentials();return a&&"undefined"!=typeof a[StackMob.REFRESH_TOKEN_KEY]&&null!==a[StackMob.REFRESH_TOKEN_KEY]},getRefreshToken:function(){var a=this.getOAuthCredentials();return a[StackMob.REFRESH_TOKEN_KEY]},hasExpiredOAuth:function(){return this.isOAuth2Mode()&&null===this.getOAuthExpireTime()||this.getOAuthExpireTime()<=(new Date).getTime()},clearOAuthCredentials:function(){StackMob.Storage.remove(StackMob.loggedInUserKey),StackMob.Storage.remove("oauth2.accessToken"),StackMob.Storage.remove(StackMob.REFRESH_TOKEN_KEY),StackMob.Storage.remove("oauth2.macKey"),StackMob.Storage.remove("oauth2.expires"),StackMob.Storage.remove("oauth2.user"),StackMob.Storage.remove("oauth2.userSchemaInfo")},getOAuthCredentials:function(){var a=StackMob.Storage.retrieve("oauth2.accessToken"),b=StackMob.Storage.retrieve("oauth2.macKey"),c=StackMob.Storage.retrieve("oauth2.expires"),d=StackMob.Storage.retrieve(StackMob.REFRESH_TOKEN_KEY),e=StackMob.Storage.retrieve("oauth2.userSchemaInfo"),f=null;try{f=JSON.parse(e)}catch(g){}if(_.every([a,b,c,d,f])){var h={"oauth2.accessToken":a,"oauth2.macKey":b,"oauth2.expires":c,"oauth2.userSchemaInfo":f};return h[StackMob.REFRESH_TOKEN_KEY]=d,h}return{}},getOAuthExpireTime:function(){var a=this.Storage.retrieve("oauth2.expires");return a?parseInt(a,10):null},METHOD_MAP:{create:"POST",read:"GET",update:"PUT","delete":"DELETE",post:"POST",get:"GET",put:"PUT",addRelationship:"POST",appendAndSave:"PUT",deleteAndSave:"DELETE",login:"GET",accessToken:"POST",refreshToken:"POST",logout:"GET",forgotPassword:"POST",loginWithTempAndSetNewPassword:"GET",resetPassword:"POST",facebookAccessToken:"POST",facebookAccessTokenWithCreate:"POST",createUserWithFacebook:"POST",linkUserWithFacebook:"GET",unlinkUserFromFacebook:"DELETE",gigyaAccessToken:"POST",linkUserWithGigya:"POST",unlinkUserFromGigya:"DELETE"},getProperty:function(a,b){return a&&a[b]?_.isFunction(a[b])?a[b]():a[b]:null},init:function(a){if(a=a||{},this.initStart(a),this.userSchema=a.userSchema,this.loginField=a.loginField,this.passwordField=a.passwordField,this.newPasswordField="new_password",this.publicKey=a.publicKey,this.apiVersion=a.apiVersion||this.DEFAULT_API_VERSION,"undefined"!=typeof a.apiURL)throw new Error("Error: apiURL is no longer supported.  The API URL is now automatically set for PhoneGap users.");var b=a.apiDomain;if("string"==typeof b){if(0===b.indexOf("http"))throw new Error("Error: apiDomain should not specify url scheme (http/https). For example, specify api.stackmob.com instead of http://api.stackmob.com. URL Scheme is determined by the 'secure' init variable.");this.apiDomain=b.indexOf("/")==b.length-1?b:b+"/"}var c=this.getHostname().indexOf(".stackmobapp.com")>0;return this.useRelativePathForAjax="boolean"==typeof a.useRelativePathForAjax?a.useRelativePathForAjax:c,this.secure=a.secure?a.secure:0===this.getProtocol().indexOf("https:")?this.SECURE_ALWAYS:0===this.getProtocol().indexOf("http:")?this.SECURE_NEVER:this.SECURE_MIXED,this.ajax=a.ajax||this.ajax,this.initEnd(a),this},initStart:function(){},initEnd:function(){},wrapStackMobCallbacks:function(){}}}.call(this),function(){function a(a,b,c,d,e,f){var g="\n";return a+g+b+g+c+g+d+g+e+g+f+g+g}function b(b,c,d,e,f,g){var h=e.split(":"),i=h.length>1?h[0]:e,j=h.length>1?h[1]:"https"==g.substring(0,5)?443:80,k=Math.round((new Date).getTime()/1e3),l="n"+Math.round(1e4*Math.random()),m=a(k,l,b,f,i,j),n=CryptoJS.HmacSHA1(m,d),o=n.toString(CryptoJS.enc.Base64);return'MAC id="'+c+'",ts="'+k+'",nonce="'+l+'",mac="'+o+'"'}function c(a){var c=a.url.match(/(^http|^https):\/\//g),d=c+StackMob.getBaseURL(),e=a.url.replace(new RegExp(d,"g"),"/"),f=d.replace(new RegExp("^http://|^https://","g"),"").replace(new RegExp("/"),""),g=StackMob.Storage.retrieve("oauth2.accessToken"),h=StackMob.Storage.retrieve("oauth2.macKey");if(StackMob.Storage.retrieve("oauth2.expires"),StackMob.isOAuth2Mode()&&g&&h){var i=b(a.type,g,h,f,e,d);return i}}function d(a,b){b=b||{};var c,d="http",e="https";if(b.secureRequest===!0)c=e;else switch(StackMob.secure){case StackMob.SECURE_ALWAYS:c=e;break;case StackMob.SECURE_NEVER:c=d;break;default:c=StackMob._isSecureMethod(a,b)?e:d}return c+"://"}function e(a,b,c){if(c=c||{},b.headers=b.headers||{},b.headers=_.extend(b.headers,{Accept:"application/vnd.stackmob+json; version="+StackMob.apiVersion}),_.extend(b.headers,{"X-StackMob-User-Agent":"StackMob (JS; "+StackMob.sdkVersion+")"}),StackMob.publicKey&&!StackMob.privateKey?(b.headers["X-StackMob-API-Key"]=StackMob.publicKey,b.headers["X-StackMob-Proxy-Plain"]="stackmob-api",b.headers["X-StackMob-API-Key-"+StackMob.publicKey]="1"):b.headers["X-StackMob-Proxy"]="stackmob-api",StackMob.isOAuth2Mode()&&StackMob.isAccessTokenMethod(a)?b.contentType="application/x-www-form-urlencoded":_.include(["PUT","POST"],StackMob.METHOD_MAP[a])&&(b.contentType=b.contentType||StackMob.CONTENT_TYPE_JSON),isNaN(c[StackMob.CASCADE_DELETE])||(b.headers["X-StackMob-CascadeDelete"]=c[StackMob.CASCADE_DELETE]===!0),c.query){var d=b.query||throwError("No StackMobQuery object provided to the query call.");if(d.selectFields&&d.selectFields.length>0&&(b.headers["X-StackMob-Select"]=d.selectFields.join()),d.range&&(b.headers.Range="objects="+d.range.start+"-"+d.range.end),_.extend(b.data,d.params),d.orderBy&&d.orderBy.length>0){for(var e=d.orderBy,f="",g=e.length,h=0;g>h;h++)f+=e[h],g>h+1&&(f+=",");b.headers["X-StackMob-OrderBy"]=f}}}function f(a){a=a||{},a.processData=!1,a.accepts=a.headers.Accept}function g(a,b){if(!StackMob.isAccessTokenMethod(a)){var d=c(b);d&&(b.headers.Authorization=d)}}var h=this;h.jQuery||h.Ext||h.Zepto,_.extend(StackMob,{isSencha:function(){return h.Ext},isZepto:function(){return h.Zepto},initEnd:function(){i(),j(),k()},cc:function(a,b,c,d){return this.customcode(a,b,c,d)},customcode:function(a,b,c,e){function f(a){return a&&!_.isUndefined(StackMob.METHOD_MAP[c.toLowerCase()])}if(_.isObject(c)){e=c||{};var g=e.httpVerb;e.httpVerb=f(g)?g:"GET"}else e=e||{},_.isString(c)&&f(c)&&(e.httpVerb=c.toUpperCase());return e.data=e.data||{},"GET"!==c&&(e.contentType=e.contentType||StackMob.CONTENT_TYPE_JSON),_.extend(e.data,b),e.url=d(a,b)+this.getBaseURL(),this.sync.call(StackMob,a,null,e)},processLogin:function(a,b){if(StackMob.isOAuth2Mode()){var c=a,d=c.access_token,e=c.refresh_token,f=c.mac_key,g=c.expires_in;try{var h=StackMob.getOAuthCredentials(),i=b.stackmob_userschemainfo||h["oauth2.userSchemaInfo"],j=i.loginField,k=a.stackmob.user[j],l=StackMob.prepareCredsForSaving(d,e,f,g,k,i);StackMob.saveOAuthCredentials(l),StackMob.Storage.persist(StackMob.loggedInUserKey,k)}catch(m){console&&console.error("Problem saving OAuth 2.0 credentials and user: "+m)}}},sync:function(a,b,c){function h(a,b,e){e=e||{};var f=d(b,e);!e.url&&a&&(e.url=f+a.url());var g="cc"!=b,h=a&&a.isNew&&!a.isNew(),i=!o,k="addRelationship"==b||"appendAndSave"==b||"deleteAndSave"==b;if(j(b)){var l=b;e.url+=("/"==e.url.charAt(e.url.length-1)?"":"/")+l}else if((k||g&&h&&i)&&(e.url+=("/"==e.url.charAt(e.url.length-1)?"":"/")+encodeURIComponent(a.get(a.getPrimaryKeyField())),k&&(e.url+="/"+c[StackMob.ARRAY_FIELDNAME]),"deleteAndSave"==b)){var m="";m=_.isArray(c[StackMob.ARRAY_VALUES])?_.map(c[StackMob.ARRAY_VALUES],function(a){return encodeURIComponent(a)}).join(","):encodeURIComponent(c[StackMob.ARRAY_VALUES]),e.url+="/"+m}}function i(a,c,d){function e(a){var b=_.map(_.keys(a),function(b){return b+"="+encodeURIComponent(a[b])});return b.join("&")}if(d=d||{},StackMob.isOAuth2Mode()&&StackMob.isAccessTokenMethod(a))c.data=e(c.data);else if("POST"==c.type||"PUT"==c.type)if("resetPassword"==a||"forgotPassword"==a)c.data=JSON.stringify(c.data);else if("addRelationship"==a||"appendAndSave"==a)d&&d[StackMob.ARRAY_VALUES]&&(c.data=JSON.stringify(d[StackMob.ARRAY_VALUES]));else if(b){var f=b.toJSON(),g=d.remote_ignore||[];if(_.each(g,function(a){delete f[a]}),delete f.lastmoddate,delete f.createddate,"update"==a){var h=d.stackmob_userschemainfo||StackMob.getOAuthCredentials()["oauth2.userSchemaInfo"];if(h){var i=h.passwordField;delete f[i]}_.each(b.getBinaryFields(),function(a){f[a]&&0===f[a].indexOf("http")&&delete f[a]})}StackMob.isOAuth2Mode()&&delete f.sm_owner,c.data=JSON.stringify(_.extend(f,c.data))}else c.data=JSON.stringify(c.data);else if("GET"==c.type||"DELETE"==c.type){if(!_.isEmpty(c.data)){c.url+="?";var j=e(c.data);c.url+=j}delete c.data}else delete c.data}function j(a){return!_.include(["create","update","delete","read","query","deleteAndSave","appendAndSave","addRelationship"],a)}if(c=c||{},!StackMob.isAccessTokenMethod(a)&&StackMob.shouldSendRefreshToken()&&c.stackmob_attempted_refresh!==!0){var k=a,l=c;l.stackmob_attempted_refresh=!0;var m=b,n=this;return StackMob.refreshSession.call(StackMob,{oncomplete:function(){StackMob.sync.call(n,k,m,l)}}),!1}var o=c[StackMob.FORCE_CREATE_REQUEST]===!0;o&&(a="create");var p=c.httpVerb||StackMob.METHOD_MAP[a]||"GET",q=_.extend({type:p},c);return q.data=q.data||{},h(b,a,q),e(a,q,c),i(a,q,c),f(q),g(a,q),StackMob.makeAPICall(b,q,a,c)},refreshSession:function(a){var b={};if(_.extend(b,a),StackMob.hasRefreshToken()){var c=StackMob.getOAuthCredentials()["oauth2.userSchemaInfo"]?StackMob.getOAuthCredentials()["oauth2.userSchemaInfo"].schemaName:StackMob.userSchema;b.url=d("refreshToken")+this.getBaseURL()+c,b.contentType="application/x-www-form-urlencoded",b.data={refresh_token:StackMob.getOAuthCredentials()[StackMob.REFRESH_TOKEN_KEY],grant_type:"refresh_token",token_type:"mac",mac_algorithm:"hmac-sha1"};var e=a.oncomplete;e&&(b.oncomplete=function(){e()}),a&&a.success&&(b.success=a.success),b.stackmob_onrefreshToken=StackMob.processLogin,b.error=function(){a&&a.error&&a.error(),StackMob.Storage.remove(StackMob.REFRESH_TOKEN_KEY)},(this.sync||Backbone.sync).call(this,"refreshToken",this,b)}else a&&a.error&&a.error()},makeAPICall:function(a,b,c,d){return StackMob.ajax?StackMob.ajax(a,b,c,d):StackMob.isSencha()?StackMob.ajaxOptions.sencha(a,b,c,d):StackMob.isZepto()?StackMob.ajaxOptions.zepto(a,b,c,d):StackMob.ajaxOptions.jquery(a,b,c,d)},onsuccess:function(a,b,c,d,e,f){if(c&&(_.isFunction(c["stackmob_on"+b])&&c["stackmob_on"+b](d,f),_.isFunction(c.oncomplete)&&c.oncomplete(d)),e)if(d)if(StackMob.isOAuth2Mode()&&StackMob.isAccessTokenMethod(b)&&d.stackmob){d=d.stackmob.user;var g=f.fullyPopulateUser===!0;if(a&&a.parse)if(g){if(!a.set(a.parse(d,f),f))return!1}else{var h={};if(h[a.getPrimaryKeyField()]=d[a.getPrimaryKeyField()],!a.set(h,f))return!1}e(d),g&&a&&a.trigger&&a.trigger("sync",a,d,f)}else e(d);else e()},onerror:function(a,b,d,e,f,g){var h,i=a.status;try{h=JSON.parse(b)}catch(j){h={error:"Invalid JSON returned."}}if(503==i){var k=a.getResponseHeader("retry-after");try{k=1e3*parseInt(responseHeaderValue,10)}catch(j){k=StackMob.RETRY_WAIT}if("number"==typeof f.stackmob_retry){if(f.stackmob_retry-=1,f.stackmob_retry<=0)return}else f.stackmob_retry=StackMob.RETRY_ATTEMPTS;_.delay(function(){var a=c(f);f.headers.Authorization=a,d&&d(f)},k)}else _.isFunction(f.oncomplete)&&f.oncomplete(h),g&&g(h)},isAccessTokenMethod:function(a){var b=["accessToken","refreshToken","facebookAccessToken","facebookAccessTokenWithCreate","gigyaAccessToken"];return _.include(b,a)},_isSecureMethod:function(a,b){var c=["loginWithTempAndSetNewPassword","createUserWithFacebook","linkUserWithFacebook","unlinkUserFromFacebook","linkUserWithGigya","unlinkUserFromGigya"];return StackMob.isAccessTokenMethod(a)?!0:b.isUserCreate===!0?!0:_.include(c,a)}});var i=function(){StackMob.Model=Backbone.Model.extend({urlRoot:StackMob.getBaseURL(),getBinaryFields:function(){return this.binaryFields||[]},url:function(){var a=StackMob.getBaseURL();return a+=this.schemaName},getPrimaryKeyField:function(){return this.schemaName+"_id"},constructor:function(){this.setIDAttribute(),Backbone.Model.prototype.constructor.apply(this,arguments)},initialize:function(){StackMob.getProperty(this,"schemaName")||StackMob.throwError("A schemaName must be defined"),this.setIDAttribute()},setIDAttribute:function(){this.idAttribute=this.getPrimaryKeyField()},sync:function(a,b,c){return StackMob.sync.call(this,a,this,c),StackMob.sync.call(this,a,this,c)},create:function(a){var b={};return b[StackMob.FORCE_CREATE_REQUEST]=!0,_.extend(b,a),this.save(null,b)},query:function(a,b){return b=b||{},_.extend(b,{query:a}),this.fetch(b)},fetch:function(a){return StackMob.wrapStackMobCallbacks.call(this,a),Backbone.Model.prototype.fetch.call(this,a)},destroy:function(a){return StackMob.wrapStackMobCallbacks.call(this,a),Backbone.Model.prototype.destroy.call(this,a)},save:function(a,b){var c=a?a.success:{},d=a?a.error:{};return"undefined"==typeof b&&(_.isFunction(c)||_.isFunction(d))?(StackMob.wrapStackMobCallbacks.call(this,a),Backbone.Model.prototype.save.call(this,null,a)):(StackMob.wrapStackMobCallbacks.call(this,b),Backbone.Model.prototype.save.call(this,a,b))},fetchExpanded:function(a,b){(0>a||a>3)&&StackMob.throwError("Depth must be between 0 and 3 inclusive.");var c={};return _.extend(c,b),c.data=c.data||{},c.data._expand=a,this.fetch(c)},getAsModel:function(a,b){var c=this.get(a);return c?_.isArray(c)?_.map(c,function(a){return new b(a)}):new b(c):{}},appendAndCreate:function(a,b,c){return this.addRelationship(a,b,c)},addRelationship:function(a,b,c){return c=c||{},c[StackMob.ARRAY_FIELDNAME]=a,c[StackMob.ARRAY_VALUES]=b,StackMob.sync.call(this,"addRelationship",this,c)},appendAndSave:function(a,b,c){return c=c||{},c[StackMob.ARRAY_FIELDNAME]=a,c[StackMob.ARRAY_VALUES]=b,StackMob.sync.call(this,"appendAndSave",this,c)},deleteAndSave:function(a,b,c,d){d=d||{},d[StackMob.ARRAY_FIELDNAME]=a,d[StackMob.ARRAY_VALUES]=b,d[StackMob.CASCADE_DELETE]=c;var e=this;return d.stackmob_ondeleteAndSave=function(){var c=e.get(a);e.set(a,_.difference(c,b))},StackMob.sync.call(this,"deleteAndSave",this,d)},setBinaryFile:function(a,b,c,d){var e="Content-Type: "+c+"\n"+"Content-Disposition: attachment; "+"filename="+b+"\n"+"Content-Transfer-Encoding: base64\n\n"+d;this.set(a,e)},incrementOnSave:function(a,b){this.attributes[this.idAttribute]?(this.attributes[a]&&delete this.attributes[a],this.set(a+"[inc]",b)):StackMob.throwError("Please specify an id for the row you wish to update. When creating a new instance of your object, you need to pass in JSON that includes the id field and value (e.g. var user = new StackMob.User({ username: 'chucknorris' });)  Or, for custom objects: var todoInstance = new Todo({todo_id : '1234'})")},decrementOnSave:function(a,b){this.incrementOnSave(a,-1*b)}})},j=function(){StackMob.Collection=Backbone.Collection.extend({initialize:function(){this.model||StackMob.throwError("Please specify a StackMob.Model for this collection. e.g., var Items = StackMob.Collection.extend({ model: Item });"),this.schemaName=(new this.model).schemaName},url:function(){var a=StackMob.getBaseURL();return a+=this.schemaName},sync:function(a,b,c){return StackMob.sync.call(this,a,this,c)},query:function(a,b){return b=b||{},_.extend(b,{query:a}),this.fetch(b)},destroyAll:function(a,b){b=b||{};var c=this,d=b.success,e=function(a){c.remove(c.models),"function"==typeof d&&d(a)};return b.success=e,_.extend(b,{query:a}),(this.sync||Backbone.sync).call(this,"delete",this,b)},create:function(a,b){var c={};return c[StackMob.FORCE_CREATE_REQUEST]=!0,_.extend(c,b),StackMob.wrapStackMobCallbacks.call(this,c),Backbone.Collection.prototype.create.call(this,a,c)},fetch:function(a){return StackMob.wrapStackMobCallbacks.call(this,a),Backbone.Collection.prototype.fetch.call(this,a)},createAll:function(a){return a=a||{},(this.sync||Backbone.sync).call(this,"create",this,a)},count:function(a,b){a=a.clone()||new StackMob.Collection.Query,b=b||{},b.stackmob_count=!0;var c=b.success,d=function(a){if(_xhr=a,a&&a.getAllResponseHeaders){var b=a.getResponseHeader("Content-Range"),d=0;if(b&&(d=b.substring(b.indexOf("/")+1,b.length)),0===d)try{d=JSON.parse(a.responseText).length}catch(e){}c&&c(d)}else c&&c(a)};return b.success=d,a.setRange&&(b.query=a.setRange(0,0)),(this.sync||Backbone.sync).call(this,"query",this,b)}})},k=function(){function a(a){return"[and"+a+"]."}function b(a){return"[or"+a+"]."}StackMob.User=StackMob.Model.extend({schemaName:StackMob.userSchema||StackMob.DEFAULT_LOGIN_SCHEMA,loginField:StackMob.loginField||StackMob.DEFAULT_LOGIN_FIELD,passwordField:StackMob.passwordField||StackMob.DEFAULT_PASSWORD_FIELD,idAttribute:this.loginField,getPrimaryKeyField:function(){return this.loginField},create:function(a){return a=a||{},a.isUserCreate=!0,StackMob.Model.prototype.create.call(this,a)},isLoggedIn:function(a){return a=a||{},StackMob._containsCallbacks(a,["yes","no"])?(a=StackMob._generateCallbacks(a,{isValidResult:function(a){return"undefined"!=typeof a},yes:a.yes,no:a.no,error:a.no}),StackMob.hasValidOAuth(a),void 0):StackMob.isUserLoggedIn(this.get(this.loginField),a)},login:function(a,b){b=b||{};var c="undefined"==typeof a?!1:a;return StackMob.keepLoggedIn(c),b.data=b.data||{},b.data[this.loginField]=this.get(this.loginField),b.data[this.passwordField]=this.get(this.passwordField),StackMob.isOAuth2Mode()&&(b.data.token_type="mac"),b.stackmob_onaccessToken=StackMob.processLogin,(this.sync||Backbone.sync).call(this,StackMob.isOAuth2Mode()?"accessToken":"login",this,b)},logout:function(a){a=a||{},a.data=a.data||{},(this.sync||Backbone.sync).call(this,"logout",this,a),StackMob.clearOAuthCredentials()},loginWithGigya:function(a,b,c,d,e){e=e||{};var f="undefined"==typeof d?!1:d;return StackMob.keepLoggedIn(f),e.data=e.data||{},_.extend(e.data,{gigya_uid:a,gigya_ts:b,gigya_sig:c,token_type:"mac"}),e.stackmob_ongigyaAccessToken=StackMob.processLogin,(this.sync||Backbone.sync).call(this,"gigyaAccessToken",this,e)},linkUserWithGigya:function(a,b,c,d){return d=d||{},d.data=d.data||{},_.extend(d.data,{gigya_uid:a,gigya_ts:b,gigya_sig:c,token_type:"mac"}),(this.sync||Backbone.sync).call(this,"linkUserWithGigya",this,d)},unlinkUserFromGigya:function(a){return(this.sync||Backbone.sync).call(this,"unlinkUserFromGigya",this,a)},loginWithFacebook:function(a,b,c){return this.loginWithFacebookToken(a,b,c)},loginWithFacebookToken:function(a,b,c){c=c||{};var d="undefined"==typeof b?!1:b;return StackMob.keepLoggedIn(d),c.data=c.data||{},_.extend(c.data,{fb_at:a,token_type:"mac"}),c.createIfNeeded===!0?(c.stackmob_onfacebookAccessTokenWithCreate=StackMob.processLogin,c.data[this.loginField]=c[this.loginField]||this.get(this.loginField),(this.sync||Backbone.sync).call(this,"facebookAccessTokenWithCreate",this,c)):(c.stackmob_onfacebookAccessToken=StackMob.processLogin,(this.sync||Backbone.sync).call(this,"facebookAccessToken",this,c))},loginWithFacebookAutoCreate:function(a,b,c){return c=c||{},c.createIfNeeded=!0,this.loginWithFacebookToken(a,b,c)},createUserWithFacebook:function(a,b){return b=b||{},b.data=b.data||{},_.extend(b.data,{fb_at:a,token_type:"mac"}),b.data[this.loginField]=b[this.loginField]||this.get(this.loginField),(this.sync||Backbone.sync).call(this,"createUserWithFacebook",this,b)},linkUserWithFacebook:function(a,b){return b=b||{},b.data=b.data||{},_.extend(b.data,{fb_at:a,token_type:"mac"}),(this.sync||Backbone.sync).call(this,"linkUserWithFacebook",this,b)},unlinkUserFromFacebook:function(a){return(this.sync||Backbone.sync).call(this,"unlinkUserFromFacebook",this,a)},loginWithTempAndSetNewPassword:function(a,b,c,d){return d=d||{},d.data=d.data||{},this.set(this.passwordField,a),d.data[StackMob.newPasswordField]=b,this.login(c,d)},forgotPassword:function(a){return a=a||{},a.data=a.data||{},a.data.username=this.get(this.loginField),(this.sync||Backbone.sync).call(this,"forgotPassword",this,a)},resetPassword:function(a,b,c){return c=c||{},c.data=c.data||{},c.data.old={password:a},c.data["new"]={password:b},(this.sync||Backbone.sync).call(this,"resetPassword",this,c)},sync:function(a,b,c){return c=c||{},c.stackmob_userschemainfo={schemaName:this.schemaName,loginField:this.loginField,passwordField:this.passwordField},StackMob.Model.prototype.sync.call(this,a,b,c)}}),StackMob.Users=StackMob.Collection.extend({model:StackMob.User}),StackMob.GeoPoint=function(a,b){_.isNumber(a)?((-90>a||a>90)&&StackMob.throwError("Latitude value must be between -90 and 90 inclusive."),(-180>b||b>180)&&StackMob.throwError("Longitude value must be between -180 and 180 inclusive."),this.lat=a,this.lon=b):((a.lat<-90||a.lat>90)&&StackMob.throwError("Latitude value must be between -90 and 90 inclusive."),(a.lon<-180||a.lon>180)&&StackMob.throwError("Longitude value must be between -180 and 180 inclusive."),this.lat=a.lat,this.lon=a.lon)},StackMob.GeoPoint.prototype.toJSON=function(){return{lat:this.lat,lon:this.lon}},StackMob.Model.Query=function(){this.selectFields=[],this.params={}},_.extend(StackMob.Model.Query.prototype,{select:function(a){return this.selectFields.push(a),this},setExpand:function(a){return this.params._expand=a,this}}),StackMob.Collection.Query=function(){this.params={},this.selectFields=[],this.orderBy=[],this.range=null},StackMob.Collection.Query.prototype=new StackMob.Model.Query,StackMob.Collection.Query.prototype.constructor=StackMob.Collection.Query(),_.extend(StackMob.Collection.Query.prototype,{or:function(c){var d,e=this;return"undefined"==typeof this.orId?(function(){d=this.clone(),d.params={},d.orId=1,d.andCount=1;var f,g,h;g=_.keys(e.params),h="",g.length>1&&(f=d.andCount++,h=a(f));var i;for(var j in e.params)i=b(d.orId)+h+j,d.params[i]=e.params[j];g=_.keys(c.params),h="",g.length>1&&(f=d.andCount++,h=a(f));for(j in c.params){if(i=b(d.orId)+h+j,"undefined"!=typeof d.params[i])throw new Error("Error: You are attempting to OR two or more values for the same field. You should use an mustBeOneOf method instead.");d.params[i]=c.params[j]}}(),d):(function(){d=this.clone();var e=_.keys(c.params);parsedAndString="",e.length>1&&(andCounter=d.andCount++,parsedAndString=a(andCounter));for(var f in c.params){var g=b(d.orId)+parsedAndString+f;if("undefined"!=typeof d.params[g])throw new Error("Error: You are attempting to OR two or more values for the same field. You should use an mustBeOneOf method instead.");d.params[g]=c.params[f]}}(),d)},and:function(a){var b=this.clone();for(var c in a.params)b.params[c]=a.params[c];return b},clone:function(){var a=_.clone(this);return a.params=_.clone(this.params),a},addParam:function(a,b){return this.params[a]=b,this},equals:function(a,b){return""===b?this.params[a+"[empty]"]=!0:this.params[a]=b,this},lt:function(a,b){return this.params[a+"[lt]"]=b,this},lte:function(a,b){return this.params[a+"[lte]"]=b,this},gt:function(a,b){return this.params[a+"[gt]"]=b,this},gte:function(a,b){return this.params[a+"[gte]"]=b,this},notEquals:function(a,b){return""===b?this.params[a+"[empty]"]=!1:this.params[a+"[ne]"]=b,this},isNull:function(a){return this.params[a+"[null]"]=!0,this},isNotNull:function(a){return this.params[a+"[null]"]=!1,this},mustBeOneOf:function(a,b){var c="";return c=_.isArray(b)?b.join():b,this.params[a+"[in]"]=c,this},mustNotBeOneOf:function(a,b){var c="";return c=_.isArray(b)?b.join():b,this.params[a+"[nin]"]=c,this},orderAsc:function(a){return this.orderBy.push(a+":asc"),this},orderDesc:function(a){return this.orderBy.push(a+":desc"),this},setRange:function(a,b){return this.range={start:a,end:b},this},mustBeNear:function(a,b,c){return this.params[a+"[near]"]=b.lat+","+b.lon+","+c,this},mustBeNearMi:function(a,b,c){return this.mustBeNear(a,b,c/StackMob.EARTH_RADIANS_MI),this},mustBeNearKm:function(a,b,c){return this.mustBeNear(a,b,c/StackMob.EARTH_RADIANS_KM),this},isWithin:function(a,b,c){return this.params[a+"[within]"]=b.lat+","+b.lon+","+c,this},isWithinMi:function(a,b,c){return this.isWithin(a,b,c/StackMob.EARTH_RADIANS_MI),this},isWithinKm:function(a,b,c){return this.isWithin(a,b,c/StackMob.EARTH_RADIANS_KM),this},isWithinBox:function(a,b,c){return this.params[a+"[within]"]=b.lat+","+b.lon+","+c.lat+","+c.lon,this}})}}.call(this),function(){var a=this,b=a.jQuery||a.Ext||a.Zepto;_.extend(StackMob,{ajaxOptions:{sencha:function(a,c,d,e){var f={},g=c.success,h=function(b){var f=null;if(b&&b.responseText)try{f=JSON.parse(b.responseText)}catch(h){f=b.responseText}c.stackmob_count===!0&&(f=b),StackMob.onsuccess(a,d,c,f,g,e)};c.success=h;var i=c.error;f.url=c.url,f.headers=c.headers,f.params=c.data,f.success=c.success,f.disableCaching=!1,f.method=c.type;var j=function(c,d){var e=c.responseText||c.text;StackMob.onerror(c,e,b.Ajax.request,a,f,i,d)};return c.error=j,f.failure=c.error,b.Ajax.request(f)},zepto:function(a,c,d,e){var f=c.success,g=function(b,g){g=b;try{g=JSON.parse(b)}catch(h){}StackMob.onsuccess(a,d,c,g,f,e)};c.success=g;var h=c.error,i=function(d){var f=d.responseText||d.text;StackMob.onerror(d,f,b.ajax,a,c,h,e)};c.error=i;var j={};return j.url=c.url,j.headers=c.headers,j.contentType=c.headers.contentType,j.type=c.type,j.data=c.data,j.success=g,j.error=i,b.ajax(j)},jquery:function(a,c,d,e){c.converters={"text json":function(a){return"string"==typeof a&&b.trim(a).length?jQuery.parseJSON(a):{}}},c.beforeSend=function(a,b){if(a.setRequestHeader("Accept",b.accepts),!_.isEmpty(b.headers))for(var c in b.headers)a.setRequestHeader(c,b.headers[c])};var f=c.error;c.error=function(d,g,h){if(0===d.status&&c.query&&"object"==typeof c.query.range)return this.success(d,g,h),void 0;var i=d.responseText||d.text;StackMob.onerror(d,i,b.ajax,a,c,f,e)};var g=c.success,h=function(b,f,h){var i;if(c.stackmob_count===!0)i=h;else if(b&&b.toJSON)i=b;else if(b&&(b.responseText||b.text))try{i=JSON.parse(b.responseText||b.text)}catch(j){i=b.responseText||b.text}else b&&(i=b);StackMob.onsuccess(a,d,c,i,g,e)};return c.success=h,b.ajax(c)}}})}.call(this);var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(255&c[e>>>2]>>>24-8*(e%4))<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(0|4294967296*a.random());return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=255&b[d>>>2]>>>24-8*(d%4);c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")
},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(255&b[d>>>2]>>>24-8*(d%4)));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,e=[],b=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)e[j]=0|a[b+j];else{var k=e[j-3]^e[j-8]^e[j-14]^e[j-16];e[j]=k<<1|k>>>31}k=(d<<5|d>>>27)+i+e[j],k=20>j?k+((f&g|~f&h)+1518500249):40>j?k+((f^g^h)+1859775393):60>j?k+((f&g|f&h|g&h)-1894007588):k+((f^g^h)-899497514),i=h,h=g,g=f<<30|f>>>2,f=d,d=k}c[0]=0|c[0]+d,c[1]=0|c[1]+f,c[2]=0|c[2]+g,c[3]=0|c[3]+h,c[4]=0|c[4]+i},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA1=d._createHelper(b),a.HmacSHA1=d._createHmacHelper(b)}(),function(){var a=CryptoJS,b=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,c){a=this._hasher=new a.init,"string"==typeof c&&(c=b.parse(c));var d=a.blockSize,e=4*d;c.sigBytes>e&&(c=a.finalize(c)),c.clamp();for(var f=this._oKey=c.clone(),g=this._iKey=c.clone(),h=f.words,i=g.words,j=0;d>j;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=a.enc;d.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp();for(var e=[],f=0;c>f;f+=3)for(var g=255&b[f>>>2]>>>24-8*(f%4),h=255&b[f+1>>>2]>>>24-8*((f+1)%4),i=255&b[f+2>>>2]>>>24-8*((f+2)%4),j=g<<16|h<<8|i,k=0;4>k&&c>f+.75*k;k++)e.push(d.charAt(63&j>>>6*(3-k)));var l=d.charAt(64);if(l)for(;e.length%4;)e.push(l);return e.join("")},parse:function(a){var b=a.length,d=this._map,e=d.charAt(64);if(e){var f=a.indexOf(e);-1!=f&&(b=f)}for(var g=[],h=0,i=0;b>i;i++)if(i%4){var j=d.indexOf(a.charAt(i-1))<<2*(i%4),k=d.indexOf(a.charAt(i))>>>6-2*(i%4);g[h>>>2]|=(j|k)<<24-8*(h%4),h++}return c.create(g,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();